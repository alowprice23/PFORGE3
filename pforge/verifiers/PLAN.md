# PLAN: `verifiers/` Directory

## 1. Directory Purpose & Scope

**Purpose**: The `verifiers/` directory contains a suite of offline tools for auditing and backtesting the behavior of the pForge system. Each verifier takes a session log (a sequence of AMP events) as input and recomputes a specific Key Performance Indicator (KPI) from the proofs in the log. This directory is what makes the system's claims about its performance and correctness **independently verifiable**.

**Scope of Ownership**:

*   **Precision@Action Verifier (`precision_at_action.py`)**: It owns the verifier that recomputes the `Precision@Action` KPI, which measures the fraction of patches that successfully fix a blocking constraint without introducing new ones.
*   **Escape Rate Verifier (`escape_rate.py`)**: It owns the verifier that measures the "escape rate" of the targeted test selectionâ€”the fraction of times that a bug was missed by the targeted tests and only caught by the full audit run.
*   **Conflict Minimality Verifier (`conflict_minimality.py`)**: It owns the verifier that checks the minimality of the hitting sets generated by the `ConflictDetectorAgent`.
*   **QED Gate Auditor (`qed_gate_audit.py`)**: It owns the auditor that verifies that all the QED gates were satisfied before the `QED.EMITTED` event was sent.
*   **KPI Reporter (`kpi_report.py`)**: It owns the tool that generates a summary report of all the key performance indicators for a given session.

**Explicitly Not in Scope**:

*   **Real-time Verification**: The verifiers in this directory are designed for offline, after-the-fact analysis. The real-time verification of proofs is handled by the agents and the `proof/` directory.
*   **Application Code**: This directory contains only verification tools, not application code.

---

## 2. File-by-File Blueprints

**Status Key:**
*   `[ ]` - Not Started
*   `[~]` - In Progress
*   `[x]` - Completed

### 2.1. `__init__.py` [x]

*   **Responsibilities**: To mark the `verifiers/` directory as a Python package.

### 2.2. `precision_at_action.py` [ ]

*   **Responsibilities**: To recompute the `Precision@Action` KPI from a session log.
*   **Algorithms**: It parses a sequence of AMP events, identifies all the `FIX.PATCH_APPLIED` events, and checks the corresponding `SPEC.CHECKED` events to see if a blocking constraint was resolved without introducing any new ones.

### 2.3. `escape_rate.py` [ ]

*   **Responsibilities**: To measure the escape rate of the targeted test selection.
*   **Algorithms**: It looks for sequences of a `FIX.PATCH_APPLIED` event with a successful targeted test run, followed by a `SPEC.CHECKED` event with a failing full audit run.

### 2.4. `conflict_minimality.py` [ ]

*   **Responsibilities**: To verify the minimality of the hitting sets generated by the `ConflictDetectorAgent`.
*   **Algorithms**: For each `CONFLICT.FOUND` event, it takes the hitting set and the set of violated constraints and checks if any proper subset of the hitting set would also resolve all the violations.

### 2.5. `qed_gate_audit.py` [ ]

*   **Responsibilities**: To audit the QED gates.
*   **Algorithms**: It finds the `QED.EMITTED` event in the session log and then works backwards to verify that all the required gates (spec satisfied, stability, no open conflicts, full audit run) were met.

### 2.6. `kpi_report.py` [ ]

*   **Responsibilities**: To generate a summary report of all the KPIs for a session.
*   **Interfaces**: This is a command-line tool that takes a session log as input and prints a human-readable report.

---

## 3. Math & Guarantees (from README)

The `verifiers/` directory is the ultimate arbiter of the system's claims. It provides the tools to independently verify all of the mathematical guarantees of the system, from the correctness of the individual proofs to the convergence of the overall optimization process. This directory is what makes the pForge system not just **correct**, but **provably correct**.
